{% extends "admin/base.html" %}

{% block title %}Forgot Password - LUNSERK SACCO{% endblock %}

{% block content %}
<div class="min-h-screen flex items-center justify-center gradient-bg py-12 px-4 sm:px-6 lg:px-8">
    <div class="max-w-md w-full animate__animated animate__fadeIn">
        <!-- Back Button -->
        <div class="mb-6">
            <a href="{{ url_for('adminauth.admin_login') }}" 
               class="inline-flex items-center text-white hover:text-blue-200 transition-colors">
                <i class="fas fa-arrow-left mr-2"></i> Back to Login
            </a>
        </div>
        
        <!-- Password Reset Card -->
        <div class="bg-white rounded-2xl shadow-2xl overflow-hidden card-hover">
            <div class="px-8 py-8">
                <!-- Success Message (if email sent) -->
                {% if email_sent %}
                <div class="mb-6 p-4 bg-green-50 rounded-lg border border-green-200 animate__animated animate__fadeIn">
                    <div class="flex">
                        <i class="fas fa-check-circle text-green-500 text-xl mr-3"></i>
                        <div>
                            <p class="font-medium text-green-800">Check Your Email</p>
                            <p class="text-sm text-green-700 mt-1">
                                Password reset instructions have been sent to your email address.
                                Please check your inbox (and spam folder).
                            </p>
                        </div>
                    </div>
                </div>
                {% endif %}
                
                <div class="text-center mb-8">
                    <div class="inline-flex items-center justify-center w-16 h-16 bg-blue-100 rounded-full mb-4">
                        <i class="fas fa-key text-blue-600 text-2xl"></i>
                    </div>
                    <h2 class="text-3xl font-bold text-gray-800 mb-2">Reset Password</h2>
                    <p class="text-gray-600">Enter your email to receive reset instructions</p>
                </div>
                
                <form id="forgotForm" method="POST" 
                      onsubmit="setLoading('resetBtn', true); return validateForm('forgotForm');">
                    <!-- Email Input -->
                    <div class="mb-6">
                        <label for="email" class="block text-sm font-medium text-gray-700 mb-2">
                            <i class="fas fa-envelope text-blue-500 mr-2"></i>Admin Email Address
                        </label>
                        <div class="relative">
                            <input type="email" id="email" name="email" 
                                   class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent input-focus transition-all duration-200"
                                   placeholder="admin@lunserk.com"
                                   required>
                            <div class="absolute right-3 top-3">
                                <i class="fas fa-user-tie text-gray-400"></i>
                            </div>
                        </div>
                        <p class="mt-2 text-sm text-gray-500">
                            Must be the email associated with your admin account
                        </p>
                    </div>
                    
                    <!-- Submit Button -->
                    <button id="resetBtn" type="submit" 
                            class="w-full btn-primary text-white font-semibold py-3 px-4 rounded-lg hover:shadow-lg transition-all duration-300 flex items-center justify-center">
                        <i class="fas fa-paper-plane mr-2"></i> Send Reset Instructions
                    </button>
                    
                    <!-- Resend Timer (for UI demonstration) -->
                    {% if email_sent %}
                    <div class="mt-4 text-center">
                        <p class="text-sm text-gray-600">
                            Didn't receive email? 
                            <span id="resendTimer" class="font-medium text-blue-600">Resend in 60s</span>
                        </p>
                    </div>
                    {% endif %}
                </form>
                
                <!-- Security Information -->
                <div class="mt-6">
                    <div class="bg-yellow-50 border-l-4 border-yellow-400 p-4">
                        <div class="flex">
                            <div class="flex-shrink-0">
                                <i class="fas fa-exclamation-triangle text-yellow-400"></i>
                            </div>
                            <div class="ml-3">
                                <p class="text-sm text-yellow-700">
                                    <strong>Security Tip:</strong> Reset links expire in 1 hour. 
                                    For security, always verify the sender's email address.
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Help Section -->
            <div class="bg-gray-50 px-8 py-4 border-t border-gray-200">
                <details class="text-center">
                    <summary class="text-sm text-gray-600 cursor-pointer hover:text-blue-600 transition-colors">
                        <i class="fas fa-question-circle mr-1"></i>
                        Need help resetting your password?
                    </summary>
                    <div class="mt-2 p-3 bg-white rounded-lg border border-gray-200 text-left">
                        <p class="text-xs text-gray-700 mb-2">
                            <i class="fas fa-phone-alt text-blue-500 mr-1"></i>
                            Contact support: <span class="font-medium">support@lunserk.com</span>
                        </p>
                        <p class="text-xs text-gray-700">
                            <i class="fas fa-clock text-blue-500 mr-1"></i>
                            Response time: 2-4 business hours
                        </p>
                    </div>
                </details>
            </div>
        </div>
    </div>
</div>

{% if email_sent %}
<script>
    // Resend timer functionality
    let timeLeft = 60;
    const timerElement = document.getElementById('resendTimer');
    const originalForm = document.getElementById('forgotForm');
    
    const timer = setInterval(() => {
        timeLeft--;
        timerElement.textContent = `Resend in ${timeLeft}s`;
        
        if (timeLeft <= 0) {
            clearInterval(timer);
            timerElement.innerHTML = '<a href="{{ url_for("adminauth.forgot_password") }}" class="text-blue-600 hover:text-blue-800">Resend Now</a>';
        }
    }, 1000);
</script>
{% endif %}
{% endblock %}